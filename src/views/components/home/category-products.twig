{% set title_element_id = 'category-products-title-' ~ (position|default(0)) %}
{% set gradient_word_active = component.enable_gradient_word and component.gradient_word %}

{% set slashbg = component.slas_hbg | default(false) %}
{% set marquee = component.marquee | default(false) %}
{% set marqueetext = component.marqueetext | default(" سرعة /// أداء /// تحكم ") %}

<!-- The class "p-4" was changed to "py-4" to remove horizontal padding -->
<section class="flex items-center my-10 relative justify-center dynamic-bg-color {{ slashbg ? 'slash-bg' : ''}}">
    {% if marquee %}

    <div class="styleish-text absolute top-10 left-0 w-full opacity-10 pointer-events-none select-none overflow-hidden" dir="ltr">
        <div class="marquee-reverse-sections flex whitespace-nowrap w-max">
            <span class="font-alshohadaa text-9xl font-bold text-white display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
            <span class="font-alshohadaa text-9xl font-bold text-white display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp;{{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
        </div>
    </div>

    <div class="styleish-text absolute bottom-10 left-0 w-full opacity-10 pointer-events-none select-none overflow-hidden" dir="ltr">
        <div class="marquee-content-sections flex whitespace-nowrap w-max">
            <span class="font-alshohadaa text-9xl font-bold text-white display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
            <span class="font-alshohadaa text-9xl font-bold text-white display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp;{{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
        </div>
    </div>
 
    {% endif %}
    <div class="relative w-full my-32">
                   {% if not component.title_inside_image %}
                                            <div class=" my-5 flex flex-col items-center justify-center w-full" >
                                            <div>
                                                {% if component.enable_gradient_title %}
                                                    <h5 class="text-2xl font-alshohadaa font-semibold bg-gradient-to-r from-primary to-scandary bg-clip-text text-transparent">{{ component.title }}</h5>
                                                {% elseif gradient_word_active %}
                                                    <h5 id="{{ title_element_id }}" class="text-2xl font-alshohadaa font-semibold dynamic-text-color">{{ component.title }}</h5>
                                                {% else %}
                                                    <h5 class="text-2xl font-alshohadaa font-semibold text-[var(--color-primary)]">{{ component.title }}</h5>
                                                {% endif %}
                                                <span class="navbar-underline"></span>
                                            </div>

                                                <h3 class=" xl:text-2xl text-xl text-[var(--color-tertiary)]" >{{ component.sub_title }} </h3>
                                         
                                            </div>
                    {% endif %}
        <!-- Relative Wrapper for Content to ensure it's above the SVG -->
        <div class="relative z-10 px-8 sm:px-12">
            <!-- Main Content -->
            <div class="flex flex-col md:flex-row items-center  ">
                <!-- Right Section: Text Content -->
                <div class=" sideimage
                 xl:w-[35rem] xl:h-[40rem]
                 lg:w-[32rem] lg:h-[36rem]
                 md:w-[28rem] md:h-[32rem]
                 sm:w-[24rem] sm:h-[28rem]
                 w-[20rem] h-[24rem]
                 max-w-full
                 aspect-[7/8]
                 justify-center flex">
                                <a href="{{ component.category_url.url }}" class="transition-all duration-200  !w-full  !h-full
                                       rounded-lg
                                       bg-center
                                       border-2
                                       border-primary 
                                      flex justify-center relative overflow-hidden">

                                    {# Conditional background: Video or Image #}
                                    {% if component.is_video and component.video_url %}
                                        {# Video Background #}
                                        <video autoplay muted loop playsinline class="absolute z-1 w-full h-full object-cover lazy">
                                            <source
                                            src="{{ component.video_url }}" type="video/mp4">
                                            {# Fallback image if video doesn't load #}
                                            <img src="{{ component.background }}" alt="Fallback image" class="absolute z-0 w-full h-full object-cover">
                                        </video>
                                    {% else %}
                                        {# Image Background #}
                      
						                <div class="absolute z-0 w-full h-full bg-cover bg-center bg-no-repeat" style="background-image: url('{{ component.background }}');"></div>

                                     {% endif %}


                                    {# Gradient Overlay #}
                                    {# <div class="absolute z-10 w-full h-full bg-gradient-to-t from-[rgba(var(--color-primary),0.9)] via-[rgba(var(--color-primary),0.3)] to-transparent"></div> #}

                                    {# Content #}
 
                                    {% if component.title_inside_image %}
                                      <div 

                                       style="{{ component.is_video ? 'z-index:100;' : '' }}"
                                      
                                      class="w-[85%]  place-self-end my-5 bg-gradient-to-tr
                                       from-[var(--color-primary-30)] 
                                       via-white/30
                                       to-[var(--color-primary-30)] 
                                       h-2/6 backdrop-blur-sm rounded-custom justify-center flex">
                                            <div class="  flex flex-col items-center justify-center rounded-custom border border-primary w-full" >
                                            {% if component.enable_gradient_title %}
                                                <h5 class="text-2xl font-alshohadaa font-semibold bg-gradient-to-r from-primary to-scandary bg-clip-text text-transparent">{{ component.title }}</h5>
                                            {% elseif gradient_word_active %}
                                                <h5 id="{{ title_element_id }}" class="text-2xl font-alshohadaa font-semibold dynamic-text-color">{{ component.title }}</h5>
                                            {% else %}
                                                <h5 class="text-2xl font-alshohadaa font-semibold text-[var(--color-primary)]">{{ component.title }}</h5>
                                            {% endif %}
                                                <h3 class=" xl:text-2xl text-xl text-[var(--color-tertiary)]" >{{ component.sub_title }} </h3>
                                        
                                                    <div class="hide-the-title  flex items-center w-1/2 my-2 justify-center"> 
                                                            <span class="navbar-underline"></span>
                                                    </div>
                                                <p class="text-xl w-5/6 mt-5">{{ component.text }}</p>
                                            </div>
                                        </div>
                                    {% endif %}
                                </a>
                </div>

                <!-- Vertical Separator -->
                {# <div class="  xl:rotate-0 rotate-90 w-px bg-[var(--color-primary)] xl:h-64"></div> #}

                <!-- Left Section: Stats Cards -->
                <div class=" justify-center xl:w-[80%] lg:w-[70%] md:w-[60%] w-full md:p-10 p-3">
                    <salla-products-slider autoplay source="selected" {# product-card-component="custom-salla-product-card-harir" #} source-value="[{{ component.products|map((product) => product.id)|join(',') }}]"></salla-products-slider>
                </div>
            </div>
        </div>
    </div>

 

</section>

{% if gradient_word_active %}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const titleEl = document.getElementById('{{ title_element_id }}');
            if (!titleEl) return;
            const word = '{{ component.gradient_word|e('js') }}';
            if (!word) return;
            const regex = new RegExp('(' + word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + ')', 'gi');
            titleEl.innerHTML = titleEl.innerHTML.replace(
                regex,
                '<span class="bg-gradient-to-r from-primary to-scandary bg-clip-text text-transparent">$1</span>'
            );
        });
    </script>
{% endif %}

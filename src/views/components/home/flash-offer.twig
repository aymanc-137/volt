{#
| Variable                          | Type     | Description                                              |
|-----------------------------------|----------|----------------------------------------------------------|
| badge_text                        | string   | Text displayed in the trending badge                     |
| title                             | string   | Main headline of the flash offer                         |
| title_accent                      | string   | Accent/highlight word in title                           |
| description                       | string   | Short description/subtitle                               |
| position                          | int      | Component position on page                               |
| full_width                        | boolean  | Whether component is full width or containerized         |
|                                   |          |                                                          |
| product                           | object   | Primary product for spotlight                            |
| product.image.url                 | string   | Product image URL                                        |
| product.name                      | string   | Product name                                             |
| product.price                     | number   | Current/sale price                                       |
| product.original_price            | number   | Original price (before discount)                         |
| product.rating.stars              | number   | Product rating (e.g., 5.0)                              |
| product.quantity_sold             | number   | Number of units sold                                     |
| product.url                       | string   | Product URL                                              |
| product.discount_ends             | string   | Countdown end date (ISO format)                          |
|                                   |          |                                                          |
| features[]                        | array    | List of product features/benefits                        |
| features[].icon                   | string   | Icon name (sicon-*)                                      |
| features[].text                   | string   | Feature description text                                 |
#}

{% set badge_text = component.badge_text is defined ? component.badge_text : 'عرض محدود الوقت' %}
{% set title = component.title is defined ? component.title : 'عرض حصري' %}
{% set title_accent = component.title_accent is defined ? component.title_accent : 'محدود الوقت' %}
{% set description = component.description is defined ? component.description : 'احصل على أفضل العروض اليوم فقط' %}
{% set full_width = component.full_width is defined ? component.full_width : false %}

{% set product = component.product|default({}) %}
{% set features = component.features|default([]) %}

<section class="flash-offer-spotlight {{ full_width ? 'w-full' : 'container mx-auto' }}">
  <div class="flash-offer-spotlight__wrapper relative overflow-hidden">
    <!-- Animated background circles -->
    <div class="flash-offer-spotlight__bg-glow absolute inset-0 opacity-5 pointer-events-none overflow-hidden">
      <div class="absolute top-20 -left-32 w-96 h-96 bg-gradient-to-br from-primary to-transparent rounded-full blur-3xl animate-pulse"></div>
      <div class="absolute -bottom-32 -right-32 w-96 h-96 bg-gradient-to-tl from-scandary to-transparent rounded-full blur-3xl animate-pulse" style="animation-delay: 1s;"></div>
    </div>

    <!-- Main content grid -->
    <div class="relative z-10 grid grid-cols-1 md:grid-cols-2 gap-0 min-h-[500px] md:min-h-[600px]">

      <!-- Left: Product Image with overlays -->
      <div class="flash-offer-spotlight__image-section group relative overflow-hidden">
        /* <style>
          .flash-offer-spotlight__image-section {
            background: linear-gradient(to bottom, var(--color-light-background), var(--color-light-foreground));
          }
          .dark .flash-offer-spotlight__image-section {
            background: linear-gradient(to bottom, var(--color-dark-background), var(--color-dark-box-background));
          }
        </style> */

        {% if product.image.url %}
          <img
            src="{{ product.image.url }}"
            alt="{{ product.name }}"
            class="w-full h-full object-cover transition-transform duration-1000 ease-out group-hover:scale-110 group-hover:rotate-2"
            loading="lazy"
          />
        {% endif %}

        <!-- Top gradient overlay -->
        <div class="absolute inset-0 pointer-events-none" style="background: linear-gradient(to bottom, rgba(var(--color-dark-box-background), 0.8), rgba(var(--color-dark-box-background), 0.4) 50%, transparent);"></div>

        <!-- Left gradient overlay -->
        <div class="absolute inset-0 pointer-events-none" style="background: linear-gradient(to right, transparent, rgba(var(--color-dark-box-background), 0.8));"></div>

        <!-- Floating stats cards (bottom-left) -->
        <div class="absolute bottom-6 left-6 z-20 space-y-3">
          <!-- Rating card -->
          {% if product.rating.stars %}
            <div class="flash-offer-spotlight__stat-card relative">
              <div class="absolute inset-0 rounded-xl blur-lg" style="background: linear-gradient(135deg, rgba(var(--color-primary), 0.2), rgba(var(--color-scandary), 0.2));"></div>
              <div class="relative rounded-xl px-4 py-3 border backdrop-blur-sm" style="background: rgba(var(--color-dark-box-background), 0.8); border-color: rgba(var(--color-primary), 0.4);">
                <div class="flex items-center gap-2">
                  <i class="sicon-star2 text-scandary"></i>
                  <span class="text-xl font-bold" style="background: linear-gradient(135deg, var(--color-primary), var(--color-scandary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                    {{ product.rating.stars }}/5
                  </span>
                </div>
                <p class="text-xs text-gray-400 mt-1">تقييم العملاء</p>
              </div>
            </div>
          {% endif %}

          <!-- Sales card -->
          {% if product.quantity_sold %}
            <div class="flash-offer-spotlight__stat-card relative">
              <div class="absolute inset-0 rounded-xl blur-lg" style="background: linear-gradient(135deg, rgba(var(--color-scandary), 0.2), rgba(var(--color-primary), 0.2));"></div>
              <div class="relative rounded-xl px-4 py-3 border backdrop-blur-sm" style="background: rgba(var(--color-dark-box-background), 0.8); border-color: rgba(var(--color-scandary), 0.4);">
                <div class="flex items-center gap-2">
                  <i class="sicon-trending-up text-primary"></i>
                  <span class="text-xl font-bold text-white">
                    {{ product.quantity_sold }}+
                  </span>
                </div>
                <p class="text-xs text-gray-400 mt-1">تم بيعه بالفعل</p>
              </div>
            </div>
          {% endif %}
        </div>
      </div>

      <!-- Right: Content section -->
      <div class="flash-offer-spotlight__content-section flex flex-col justify-center px-6 md:px-12 py-8 md:py-12 space-y-6">
        <style>
          .flash-offer-spotlight__content-section {
            background: linear-gradient(180deg, var(--color-light-foreground), var(--color-light-background));
          }
          .dark .flash-offer-spotlight__content-section {
            background: linear-gradient(180deg, var(--color-dark-box-background), var(--color-dark-background));
          }
        </style>

        <!-- Badge -->
        <div class="inline-flex items-center gap-2 w-fit">
          <div class="relative">
            <div class="absolute inset-0 rounded-full blur-sm opacity-75" style="background: linear-gradient(90deg, var(--color-primary), var(--color-scandary), var(--color-primary));"></div>
            <div class="relative text-white px-6 py-2 rounded-full text-sm font-bold uppercase tracking-wider animate-pulse" style="background: linear-gradient(90deg, var(--color-primary), var(--color-scandary), var(--color-primary));">
              <i class="sicon-trending-up inline mr-2"></i>
              {{ badge_text }}
            </div>
          </div>
        </div>

        <!-- Title -->
        <div class="space-y-3">
          <h2 id="flash-offer-title-{{ position }}" class="text-3xl md:text-5xl font-bold leading-tight">
            <span class="block text-gray-900 dark:text-white">{{ title }}</span>
            <span class="block" style="background: linear-gradient(90deg, var(--color-primary), var(--color-scandary), var(--color-primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
              {{ title_accent }}
            </span>
          </h2>
          <p class="text-base md:text-lg text-gray-600 dark:text-gray-400 max-w-lg">
            {{ description }}
          </p>
        </div>

        <!-- Countdown timer -->
        {% if product.discount_ends %}
          <div class="flash-offer-spotlight__countdown relative pt-4">
            <p class="text-sm font-bold uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-4">
              ينتهي العرض خلال
            </p>
            <salla-count-down
              date="{{ product.discount_ends }}"
              end-of-day="true"
              boxed="true"
              labeled="true"
              class="flash-offer-spotlight__timer">
            </salla-count-down>
          </div>
        {% endif %}

        <!-- Pricing -->
        <div class="space-y-3 pt-4">
          <div class="flex items-center gap-4">
            {% if product.price %}
              <span class="text-4xl md:text-5xl font-bold" style="background: linear-gradient(90deg, var(--color-primary), var(--color-scandary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                {{ salla.helpers.money(product.price) }}
              </span>

              {% if product.original_price and product.original_price > product.price %}
                {% set discount_percent = ((product.original_price - product.price) / product.original_price * 100)|round %}
                <div class="inline-flex items-center gap-2 rounded-lg px-3 py-1 border" style="background: rgba(var(--color-scandary), 0.2); border-color: var(--color-scandary);">
                  <span class="font-bold text-sm" style="color: var(--color-scandary);">
                    وفّر {{ discount_percent }}%
                  </span>
                </div>
              {% endif %}
            {% endif %}
          </div>

          {% if product.original_price %}
            <p class="text-2xl text-gray-400 dark:text-gray-500 line-through">
              {{ salla.helpers.money(product.original_price) }}
            </p>
          {% endif %}
        </div>

        <!-- Features list -->
        {% if features %}
          <ul class="space-y-3 pt-4">
            {% for feature in features %}
              <li class="flex items-center gap-3 text-gray-700 dark:text-gray-300" style="animation: fadeInUp 0.6s ease-out forwards; animation-delay: {{ loop.index0 * 0.1 }}s;">
                <span class="flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full border" style="background: rgba(var(--color-primary), 0.2); border-color: var(--color-primary);">
                  <i class="sicon-{{ feature.icon | default('check') }} text-sm" style="color: var(--color-primary);"></i>
                </span>
                <span class="text-sm md:text-base">{{ feature.text }}</span>
              </li>
            {% endfor %}
          </ul>
        {% endif %}

        <!-- CTA Button -->
        {% if product.url %}
          <div class="pt-4">
            <a href="{{ product.url }}" class="inline-flex items-center justify-center gap-3 w-full md:w-auto min-h-14 px-8 py-3 text-white font-bold text-lg rounded-xl transition-all duration-300 ease-out shadow-lg hover:shadow-2xl group/cta" style="background: linear-gradient(90deg, var(--color-primary), var(--color-scandary));">
              <i class="sicon-shopping-bag text-xl" style="transition: transform 0.3s; transform: scale(1);"></i>
              <span>أضف إلى السلة</span>
              <i class="sicon-lightning text-xl" style="transition: transform 0.3s; transform: rotate(0deg);"></i>
            </a>
            <style>
              .group\/cta:hover {
                background: linear-gradient(90deg, var(--color-scandary), var(--color-primary)) !important;
              }
              .group\/cta:hover .sicon-shopping-bag {
                transform: scale(1.1) !important;
              }
              .group\/cta:hover .sicon-lightning {
                transform: rotate(12deg) !important;
              }
            </style>
          </div>
        {% endif %}
      </div>
    </div>

    <!-- Animated border corners -->
    <div class="absolute top-0 left-0 w-12 h-12 border-t-2 border-l-2" style="border-color: rgba(var(--color-primary), 0.3);"></div>
    <div class="absolute top-0 right-0 w-12 h-12 border-t-2 border-r-2" style="border-color: rgba(var(--color-scandary), 0.3);"></div>
    <div class="absolute bottom-0 left-0 w-12 h-12 border-b-2 border-l-2" style="border-color: rgba(var(--color-scandary), 0.3);"></div>
    <div class="absolute bottom-0 right-0 w-12 h-12 border-b-2 border-r-2" style="border-color: rgba(var(--color-primary), 0.3);"></div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const flashOfferSection = document.querySelector('.flash-offer-spotlight');
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1 });
    observer.observe(flashOfferSection);
  });
</script>

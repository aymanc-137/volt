{% set slashbg = component.slas_hbg | default(false) %}
{% set marquee = component.marquee | default(false) %}
{% set marqueetext = component.marqueetext | default(" سرعة /// أداء /// تحكم ") %}
{% set enable_border = component.enable_border | default(false) %}
{% set enable_glow = component.enable_glow | default(false) %}
{% set marquee_text_position = component.marquee_text_position | default('both') %}
{% set marquee_is_moving = component.marquee_is_moving %}
{% set marquee_text_size = component.marquee_text_size | default('8') %}
{% set slas_hbg_size = component.slas_hbg_size | default('20') %}
{% set slas_hbg_use_primary_color = component.slas_hbg_use_primary_color %}
{% set slas_hbg_color = component.slas_hbg_color~"1A" | default('#0000001A') %}

<section class="flash-offer z-10 overflow-hidden relative {{ enable_border ? 'border-y border-[var(--color-primary)]' : ''}} {{ slashbg ? 'slash-bg-' ~ position ~ ' dynamic-bg-color' : ''}}">
    {% if enable_glow %}
    <!-- Glow balls -->
    <div class="absolute top-[15%] left-[25%] w-64 h-64 rounded-full blur-3xl opacity-60 pointer-events-none" style="background-color: var(--color-primary);"></div>
    <div class="absolute bottom-[15%] right-[25%] w-56 h-56 rounded-full blur-3xl opacity-60 pointer-events-none" style="background-color: var(--color-scandary);"></div>
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-52 h-52 rounded-full blur-3xl opacity-60 pointer-events-none" style="background-color: var(--color-primary);"></div>
    {% endif %}
    {% if marquee %}

    {% if marquee_text_position == 'top' or marquee_text_position == 'both' %}
    <div class="styleish-text absolute top-10 left-0 w-full opacity-10 pointer-events-none select-none overflow-hidden" dir="ltr">
        <div 
        style="font-size: {{marquee_text_size}}rem; line-height:1;"
        class="{{ marquee_is_moving ? 'marquee-reverse-sections' : '' }} flex whitespace-nowrap w-max">
            <span class="font-alshohadaa font-bold display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
            <span class="font-alshohadaa font-bold display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp;{{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
        </div>
    </div>
    {% endif %}

    {% if marquee_text_position == 'bottom' or marquee_text_position == 'both' %}
    <div class="styleish-text absolute bottom-10 left-0 w-full opacity-10 pointer-events-none select-none overflow-hidden" dir="ltr">
        <div
        style="font-size: {{marquee_text_size}}rem; line-height:1;"
        class="{{ marquee_is_moving ? 'marquee-content-sections' : '' }} flex whitespace-nowrap w-max">
            <span class="font-alshohadaa font-bold display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
            <span class="font-alshohadaa font-bold display-text whitespace-nowrap px-4">
                {{marqueetext}}&nbsp;&nbsp;&nbsp;{{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}&nbsp;&nbsp;&nbsp; {{marqueetext}}
            </span>
        </div>
    </div>
    {% endif %}

    {% endif %}

     <div class="flash-offer-container shadow-pulse">
    <img src="{{ component.image }}" alt="{{ component.title }}"  >
        {% set has_gradient_word = component.enable_gradient_word|default(false) and component.gradient_word is not empty %}
        {% set flash_offer_title_id = has_gradient_word ? 'flash-offer-title-' ~ (position|default(0)) : null %}
        <div class="flash-offer-content w-1/2
        p-5 flex flex-col justify-evenly 
        ">
        <p class="flash-offer-badge">{{ component.badge_text }}</p>
            <h2 class="flash-offer-title font-alshohadaa text-2xl dynamic-text-color"{% if has_gradient_word %} id="{{ flash_offer_title_id }}"{% endif %}>{{ component.title }}</h2>

              <div class="w-full mx-auto  flash-offer-count-down">
                    <salla-count-down
                      date="{{component.product[0].discount_ends}}"  
                     end-of-day="{{true}}" boxed="{{true}}"
                    labeled="{{true}}">
                    </salla-count-down>
                </div>


            <p class="flash-offer-description dynamic-text-color">{{ component.badge_text }}</p>

                <p class="flash-offer-description dynamic-text-color">{{ component.description }}</p>
                    <salla-button class="volt" href="{{component.product[0].url }}" color="primary" class="btn--rounded-full !text-white">
                        {{component.url}}
                    </salla-button>
 
        </div>
        </div>
</section>

{% if has_gradient_word %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const titleEl = document.getElementById('{{ flash_offer_title_id }}');
    if (titleEl && !titleEl.dataset.gradientApplied) {
      const word = '{{ component.gradient_word|e('js') }}';
      if (word.trim().length) {
        const regex = new RegExp('(' + word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + ')', 'gi');
        titleEl.innerHTML = titleEl.innerHTML.replace(
          regex,
          '<span class="bg-gradient-to-r from-primary to-scandary bg-clip-text text-transparent">$1</span>'
        );
        titleEl.dataset.gradientApplied = 'true';
      }
    }
  });
</script>
{% endif %}

<style>
{% if slas_hbg_use_primary_color %}
.slash-bg-{{position}} {
   background: linear-gradient(135deg, var(--color-primary-10) 25%, rgba(0, 0, 0, 0)  
   25%, rgba(0, 0, 0, 0)  50%, var(--color-primary-10)  50%, 
                                var(--color-primary-10) 75%, rgba(0, 0, 0, 0) 75%);
  background-size: {{slas_hbg_size}}px {{slas_hbg_size}}px;
}
{% else %}
.slash-bg-{{position}} {
   background: linear-gradient(135deg, {{slas_hbg_color}} 25%, rgba(0, 0, 0, 0)  
   25%, rgba(0, 0, 0, 0)  50%, {{slas_hbg_color}}  50%, 
                                {{slas_hbg_color}} 75%, rgba(0, 0, 0, 0) 75%);
  background-size: {{slas_hbg_size}}px {{slas_hbg_size}}px;
}
{% endif %}
</style>

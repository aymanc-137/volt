{#
| Variable                        | Type     | Description                                                                  |
|---------------------------------|----------|------------------------------------------------------------------------------|
| component                       | object   | Contains merchant settings for fields from twilight.json `component` section |
| component.slides                | object[] | list of slides                                                                |
| component.slides[].image        | string   | URL of slide image                                                            |
| component.slides[].image_alt    | ?string  | Accessible alternative text                                                   |
| component.slides[].title        | ?string  | Slide headline                                                                |
| component.slides[].description  | ?string  | Slide description                                                             |
| component.slides[].button_label | ?string  | CTA button label                                                              |
| component.slides[].button_url   | ?string  | CTA button link                                                               |
| component.slides[].content_alignment | ?string  | Content alignment (start, center, end)                                        |
| position                        | int      | Sorting number start from zero                                                |
#}

{% set slides = component.slides  %}
{% set animation_type = component.animation_type[0].value ?? 'slide' %}

<h1>{{ animation_type | json_encode }}</h1>

{% set block_id = 'enhanced-image-carousel-' ~ position %}

<section dir="ltr"  class="h-[80vh] w-full" id="{{ block_id }}">
    <div
        class="enhanced-carousel h-full  relative group/carousel"
        data-enhanced-carousel
        data-carousel-id="{{ block_id }}"
        data-animation-type="{{ animation_type }}"
    >
        <div class="relative overflow-hidden h-full  bg-white dark:bg-dark-box-background">
            <div class="{% if animation_type == 'fade' %}relative{% else %}flex transition-transform{% endif %} h-full duration-500 ease-in-out will-change-transform" data-carousel-track>
                {% for slide in slides %}
                {% set alignment = slide.content_alignment ?? 'center' %}
                    
                    {% set alignment_class = {
                        'start': 'items-start text-left rtl:text-right',
                        'center': 'items-center text-center',
                        'end': 'items-end text-right rtl:text-left'
                    } %} 

              
                    {# [alignment] ?? 'items-center text-center' #}
                    <article class="{% if animation_type == 'fade' %}absolute inset-0 opacity-0 transition-opacity duration-500{% else %}relative w-full shrink-0{% endif %} h-full" data-carousel-slide>
                        <img
                            class="h-full w-full object-cover "
                            src="{{ slide.image }}"
                            alt="{{ (slide.image_alt ?: slide.title ?: 'carousel-slide-' ~ loop.index)|e('html_attr') }}"
                            loading="lazy"
                            decoding="async"
                        >
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
                        <div class="absolute inset-0">
                            <div dir="rtl" class="flex h-full w-full px-6 py-10 sm:px-12 md:px-16 lg:px-20">
                                <div class="flex my-auto w-full max-w-2xl flex-col gap-4 text-white {{alignment_class[alignment[0]] ?? 'items-center text-center'}}">
                                    {% if slide.title %}
                                        <h3 class="text-2xl font-semibold sm:text-3xl lg:text-4xl">{{ slide.title }}</h3>
                                    {% endif %}
                                    {% if slide.description %}
                                        <p class="text-base sm:text-lg lg:text-xl text-white/80">{{ slide.description }}</p>
                                    {% endif %}
                                    {% if slide.button_label and slide.button_url %}
                                        <div class="pt-4">
                                            <a
                                                class="inline-flex items-center justify-center rounded-full bg-primary px-6 py-3 text-sm font-semibold uppercase tracking-wide text-primary-reverse transition hover:bg-primary-dark focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-dark focus-visible:ring-offset-2"
                                                href="{{ slide.button_url }}"
                                            >
                                                {{ slide.button_label }}
                                            </a>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </article>
                {% endfor %}
            </div>
        </div>

        {% if slides|length > 1 %}
            <button
                type="button"
                class="group absolute top-1/2 left-4 hidden h-12 w-12 -translate-y-1/2 items-center justify-center rounded-full bg-white/80 text-primary shadow-lg transition-all opacity-0 group-hover/carousel:opacity-100 hover:bg-white focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 md:flex"
                data-carousel-prev
                aria-label="السابق"
            >
                <span class="sr-only">السابق</span>
                <i class="sicon-chevron-left text-xl transition group-hover:-translate-x-1"></i>
            </button>
            <button
                type="button"
                class="group absolute top-1/2 right-4 hidden h-12 w-12 -translate-y-1/2 items-center justify-center rounded-full bg-white/80 text-primary shadow-lg transition-all opacity-0 group-hover/carousel:opacity-100 hover:bg-white focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 md:flex"
                data-carousel-next
                aria-label="التالي"
            >
                <span class="sr-only">التالي</span>
                <i class="sicon-chevron-right text-xl transition group-hover:translate-x-1"></i>
            </button>

            <div   class="mt-6 flex items-center justify-center gap-2" data-carousel-dots>
                {% for slide in slides %}
                    <button
                        type="button"
                        class="h-2.5 w-2.5 rounded-full bg-white/40 transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white"
                        data-carousel-dot="{{ loop.index0 }}"
                        aria-label="انتقال إلى الشريحة {{ loop.index }}"
                    ></button>
                {% endfor %}
            </div>
            
        {% endif %}
    </div>
</section>

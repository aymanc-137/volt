{#
| Variable                    | Type    | Description                                        |
|-----------------------------|---------|-----------------------------------------------------|
| title                       | string  | Section title                                       |
| description                 | string  | Section description                                 |
| enable_border               | boolean | Enable top/bottom border with primary color         |
| locations[]                 | array   | Array of location objects                           |
| locations[].name            | string  | Location name                                       |
| locations[].address         | string  | Full address                                        |
| locations[].phone           | string  | Phone number                                        |
| locations[].email           | string  | Email address                                       |
| locations[].working_hours   | string  | Working hours text                                  |
| locations[].map_embed       | string  | Google Maps embed URL                               |
| locations[].image           | string  | Location image URL (optional)                       |
| position                    | int     | Component position in the page                      |
#}

{% set enable_border = component.enable_border | default(false) %}
{% set title = component.title | default('مواقعنا') %}
{% set description = component.description | default('') %}
{% set locations = component.locations | default([]) %}

<section class="s-block s-block--locations py-12 md:py-16 {{ enable_border ? 'border-y border-[var(--color-primary)]' : '' }}">
    <div class="container">
        <!-- Section Header -->
        {% if title or description %}
        <div class="text-center mb-10 md:mb-14">
            {% if title %}
            <h2 class="text-2xl md:text-4xl font-bold mb-4 dynamic-text-color">
                <span class="bg-gradient-to-r from-[var(--color-primary)] to-[var(--color-scandary)] bg-clip-text text-transparent">
                    {{ title }}
                </span>
            </h2>
            {% endif %}
            {% if description %}
            <p class="text-gray-500 dark:text-gray-400 max-w-2xl mx-auto text-sm md:text-base">
                {{ description }}
            </p>
            {% endif %}
        </div>
        {% endif %}

        <!-- Locations Grid -->
        {% if locations | length > 0 %}
        <div class="grid grid-cols-1 {% if locations | length > 1 %}lg:grid-cols-2{% endif %} gap-6 md:gap-8">
            {% for location in locations %}
            <div class="location-card dynamic-bg-color rounded-custom overflow-hidden dynamic-border-color border hover:shadow-lg transition-all duration-300 group">
                <!-- Map Section -->
                {% if location.map_embed %}
                <div class="location-card__map relative h-[250px] md:h-[300px] overflow-hidden">
                    <iframe 
                        src="{{ location.map_embed }}"
                        width="100%" 
                        height="100%" 
                        style="border:0;" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade"
                        class="w-full h-full"
                    ></iframe>
                    <!-- Map Overlay Gradient -->
                    <div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </div>
                {% elseif location.image %}
                <div class="location-card__image relative h-[250px] md:h-[300px] overflow-hidden">
                    <img 
                        src="{{ location.image }}" 
                        alt="{{ location.name }}" 
                        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                        loading="lazy"
                    />
                    <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                </div>
                {% endif %}

                <!-- Contact Info Section -->
                <div class="location-card__info p-5 md:p-6">
                    <!-- Location Name -->
                    {% if location.name %}
                    <h3 class="text-xl md:text-2xl font-bold mb-4 dynamic-text-color flex items-center gap-2">
                        <span class="w-8 h-8 rounded-full bg-gradient-to-br from-[var(--color-primary)] to-[var(--color-scandary)] flex items-center justify-center flex-shrink-0">
                            <i class="sicon-map-marker-alt text-white text-sm"></i>
                        </span>
                        {{ location.name }}
                    </h3>
                    {% endif %}

                    <div class="space-y-3">
                        <!-- Address -->
                        {% if location.address %}
                        <div class="flex items-start gap-3 group/item">
                            <div class="w-10 h-10 rounded-lg bg-[var(--color-primary)]/10 flex items-center justify-center flex-shrink-0 transition-colors group-hover/item:bg-[var(--color-primary)]/20">
                                <i class="sicon-location text-[var(--color-primary)] text-lg"></i>
                            </div>
                            <div>
                                <span class="text-xs text-gray-400 uppercase tracking-wider">{{ 'العنوان' | trans }}</span>
                                <p class="dynamic-text-color text-sm md:text-base">{{ location.address }}</p>
                            </div>
                        </div>
                        {% endif %}

                        <!-- Phone -->
                        {% if location.phone %}
                        <div class="flex items-start gap-3 group/item">
                            <div class="w-10 h-10 rounded-lg bg-[var(--color-primary)]/10 flex items-center justify-center flex-shrink-0 transition-colors group-hover/item:bg-[var(--color-primary)]/20">
                                <i class="sicon-phone text-[var(--color-primary)] text-lg"></i>
                            </div>
                            <div>
                                <span class="text-xs text-gray-400 uppercase tracking-wider">{{ 'الهاتف' | trans }}</span>
                                <a href="tel:{{ location.phone }}" class="block dynamic-text-color text-sm md:text-base hover:text-[var(--color-primary)] transition-colors" dir="ltr">
                                    {{ location.phone }}
                                </a>
                            </div>
                        </div>
                        {% endif %}

                        <!-- Email -->
                        {% if location.email %}
                        <div class="flex items-start gap-3 group/item">
                            <div class="w-10 h-10 rounded-lg bg-[var(--color-primary)]/10 flex items-center justify-center flex-shrink-0 transition-colors group-hover/item:bg-[var(--color-primary)]/20">
                                <i class="sicon-mail text-[var(--color-primary)] text-lg"></i>
                            </div>
                            <div>
                                <span class="text-xs text-gray-400 uppercase tracking-wider">{{ 'البريد الإلكتروني' | trans }}</span>
                                <a href="mailto:{{ location.email }}" class="block dynamic-text-color text-sm md:text-base hover:text-[var(--color-primary)] transition-colors break-all">
                                    {{ location.email }}
                                </a>
                            </div>
                        </div>
                        {% endif %}

                        <!-- Working Hours -->
                        {% if location.working_hours %}
                        <div class="flex items-start gap-3 group/item">
                            <div class="w-10 h-10 rounded-lg bg-[var(--color-primary)]/10 flex items-center justify-center flex-shrink-0 transition-colors group-hover/item:bg-[var(--color-primary)]/20">
                                <i class="sicon-clock text-[var(--color-primary)] text-lg"></i>
                            </div>
                            <div>
                                <span class="text-xs text-gray-400 uppercase tracking-wider">{{ 'ساعات العمل' | trans }}</span>
                                <p class="dynamic-text-color text-sm md:text-base">{{ location.working_hours }}</p>
                            </div>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-wrap gap-3 mt-6 pt-5 border-t dynamic-border-color">
                        {% if location.phone %}
                        <a href="tel:{{ location.phone }}" 
                           class="flex-1 min-w-[140px] inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-custom bg-gradient-to-r from-[var(--color-primary)] to-[var(--color-scandary)] text-white font-medium text-sm hover:opacity-90 transition-opacity">
                            <i class="sicon-phone"></i>
                            {{ 'اتصل بنا' | trans }}
                        </a>
                        {% endif %}
                        {% if location.map_embed %}
                        <a href="https://maps.google.com/?q={{ location.address | url_encode }}" 
                           target="_blank"
                           rel="noopener noreferrer"
                           class="flex-1 min-w-[140px] inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-custom border-2 border-[var(--color-primary)] text-[var(--color-primary)] font-medium text-sm hover:bg-[var(--color-primary)] hover:text-white transition-all">
                            <i class="sicon-directions"></i>
                            {{ 'احصل على الاتجاهات' | trans }}
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- Empty State -->
        <div class="text-center py-12 dynamic-bg-color rounded-custom dynamic-border-color border">
            <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-[var(--color-primary)]/20 to-[var(--color-scandary)]/20 flex items-center justify-center">
                <i class="sicon-map-marker-alt text-3xl text-[var(--color-primary)]"></i>
            </div>
            <p class="text-gray-500 dark:text-gray-400">{{ 'لا توجد مواقع متاحة حالياً' | trans }}</p>
        </div>
        {% endif %}
    </div>
</section>

<style>
    .location-card {
        position: relative;
    }
    
    .location-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, var(--color-primary), var(--color-scandary));
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .location-card:hover::before {
        opacity: 1;
    }
    
    .location-card__map iframe {
        filter: grayscale(20%) contrast(1.1);
        transition: filter 0.3s ease;
    }
    
    .location-card:hover .location-card__map iframe {
        filter: grayscale(0%) contrast(1);
    }
</style>
